<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>kuramoto model simulator</title>
    <link rel="stylesheet" href="style.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module" src="kuramoto_model_simulator.js"></script>
    <script src="main.js"></script>
  </head>
  <body>
    <div id='main'></div>
    <div>
      <h2>蔵本モデルシミュレーター</h2>
      <p>このアプリは<a href="https://w.wiki/B4Y3" target="_blank">蔵本モデル</a>
      のシミュレーターです。複数の振動子の同期をシミュレートします。</p>
      <h3>モデルについて</h3>
      <p>
      蔵本モデルは、\( N \) 個の振動子 \( i \) の振る舞いを記述します。各振動子 \( i \) に固有な角速度 \( \omega_i \) に対して全ての振動子との位相差の \( sin \) の平均の \( K \) 倍を加えて角速度とします。

      $$
      \frac{ \partial \theta_i }{ \partial t } =
      \omega_i + \frac{K}{N} \sum_{j=1}^{N} \sin (\theta_j - \theta_i)
      $$


      振動子 \( i \) について、角速度 \( \frac{ \partial \theta_i }{ \partial t } \)に対して微小時間 \( \Delta t \) を乗じて現在の位相 \( \theta_i \)に加えることで次のステップの位相とします。

      $$
      \dot{\theta_i} = \theta_i + \frac{ \partial \theta_i }{ \partial t } \Delta t
      $$

      複素平面上で全ての振動子を位置の平均を重心(質量中心) \( M \) とします。 複素平面上で原点から重心までの距離を秩序変数 \( R \) とします。複素平面上で重心が x 軸となす角を位相 \( \psi \) とします。

      $$
      \begin{align}
      M &= \frac{1}{N} \sum_{j=1}^{N} e^{i \theta_j} \\
      R &= \| M \| \\
      \psi &= \arg M
      \end{align}
      $$

      実際の数値計算は、蔵本モデルの数式を変形して計算量を削減しています。

      $$
      \frac{ \partial \theta_i }{ \partial t } =
      \omega_i + K R \sin (\psi - \theta_i)
      $$

      このアプリでは秩序変数がどの程度 \( 1 \) に近づくかを Error Order Score (EOS) と呼び、以下の通り定義します。1 に近づく際の誤差の桁数を利用しています。

      $$
      EOS := \min (1,  \frac{-\log10(1 - R)}{15})
      $$

      各振動子の角速度 \( \omega_i \) の初期値は、平均 omega_mu、標準偏差 omega_sigma の正規分布に従います。

      </p>
      <h3>蔵本転移点</h3>
      <p>
      秩序変数 \( R \) は結合強度 \( K \) の増加に従って単調増加するのではなく \( K=K_c \) において相転移が起きます。この \( K_c \) は蔵本転移点と呼ばれ、いくつかの条件のもとに確率密度関数 \( g(\omega) \) を使って以下の通り表されます。

      $$
      K_c = \frac{2}{\pi g(0)}
      $$

      このアプリでは、角速度の初期値として正規分布を利用したため確率密度関数 \( g(\omega) \) は、

      $$
      g(\omega) = \frac{1}{\sqrt{2 \pi \sigma^2}}
      \exp (- \frac{(\omega - \mu)^2}{2})
      $$

      としました。

      </p>
    </div>
  </body>
</html>
